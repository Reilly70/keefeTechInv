<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <title>Itemslist</title>
  <link href="itemstyle.css" rel="stylesheet" type="text/css"/>
  <link rel="icon" type="image/x-icon" href="images/Logo.png">

  <!--Google Fonts-->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@200..700&display=swap" rel="stylesheet">
</head>
  
<body>
  <nav class="nav-container">
    <div class="nav-item" id="item1"> 
        <a class="title" href="itemlist.html"><img src="images/Logo.png" width="125" alt="drawing of a welder">
        Keefe Tech Inventory</a>
    </div>

    <div class="nav-item" id="item2"> 
      <form  action="/action_page.php">
        <input class="searchBar" type="text" placeholder="Search..." name="search">
      </form>
    </div>

    <div class="nav-item" id="item3"> 
      <br>
       <!-- ADD SIDE OVERLAY NAVIGATION W3C SCHOOLS-->
      <div id="barMenu" class="dropbtn" onclick="myFunction(this)">
        <div class="bar1"></div>
        <div class="bar2"></div>
        <div class="bar3"></div>
      
        <div id="dropDown" class="dropdown-content">
         <a href="itemlist.html">Items</a>
         <a href="class.html">Classes</a>
         <a href="#logout">Log Out</a> <!--ADD LOGOUT LINK-->
        </div>
      </div>      
            
    </div>  

    <div class="profile">
      <button class="profile-button" onclick="openForm()">P</button>
    </div>      

  </nav>

  <!-- INSIDE THE PROFILE BOX -->
  <div class="form-popup" id="myForm">
    <form action="/action_page.php" class="form-container">
      <h1><i>NAME</h1></i>

      <!--<h4 id="Name">Jam</h4>-->
      <div class="profDisplay">
        <button type="button" class="profilePage" onclick="closeForm()"><img src="images/profile.png" width="80" alt="placeholder"></button>
      </div>
      <h4 id="Email">jam.keefe</h4>
      <h5 id="Account">Student Account</h5>
      <button type="button" class="btn Manage account" onclick="closeForm()">Manage Account</button>
      <a href="login.html">
      <button type="button" class="btn logout" >logout</button>
      </a>
      <button type="button" class="btn cancel" onclick="closeForm()">Close</button>
    </form>
  </div>
  

  <button class="tool-button buttonOrange" onclick="openItemForm()">+</button>
  <div class="tool-popup" id="myItemForm">
    <form class="tool-container">
      <h1>New Tool</h1>

      <label for="toolname"><b>Tool Name</b></label>
      <input type="text" placeholder="Enter Tool Name" name="name" id="nameInput">

      <label for="quantity"><b>Quantity</b></label>
      <input type="text" placeholder="Enter Quantity" name="quantity" id="quantityInput">

      <label for="myfile"><b>Image</b></label>
      <input type="file" id="imageInput" onchange="return fileValidation()">

      <div id="imagePreview"></div>

      <button type="button" class="btn" onclick="itemSpawn()">Create Tool</button> 
      <button type="button" class="btn cancel" onclick="closeItemForm()">Cancel</button>
    </form>
  </div>

      <script>
        var x = ''
        function itemSpawn() {
          var spawnCondition = document.getElementById("nameInput") //Simple check to make sure user input proper values into the card create
          var spawnCondition2 = document.getElementById("quantityInput")
      
          if (spawnCondition.value != "" && spawnCondition2.value != "") {
            var x = document.createElement("Button"); //Main Button
            const newDiv = document.createElement("div");
            const theP = document.createElement("p");
            const imageCard = document.createElement("div");

            newDiv.classList.add("border");
            imageCard.classList.add("imageCard");
            x.setAttribute("class", "grid-item");

            var txtConvert = document.getElementById('nameInput').value;
            theP.innerText = txtConvert; //Gets Inputted Name And Puts It On Card

            newDiv.appendChild(theP); //Adds div with border for text into the main button
            document.getElementsByClassName("grid-container")[0].appendChild(x);
        
            

            x.appendChild(newDiv);
            x.appendChild(imageCard);

            spawnCondition.value = "";
            document.getElementById("nameInput").value = spawnCondition.value;
            document.getElementById("quantityInput").value = spawnCondition.value;
            document.getElementById("imageInput").value = spawnCondition.value;
            document.getElementById('imagePreview').innerHTML = '';
          }
        }

        function openItemForm() {
          document.getElementById("myItemForm").style.display = "block";
        }

        function closeItemForm() {
          document.getElementById("myItemForm").style.display = "none";
        }
        
        function openForm() {
          document.getElementById("myForm").style.display = "block";
        }

        function closeForm() {
          document.getElementById("myForm").style.display = "none";
        }

        function fileValidation() { //Alert Invalid File Type Keeps Popping Up, No Preview Div Currently
          var imageConvert = document.getElementById('imageInput');
          var imageValue = imageConvert.value;
          var allowExtension = /(\.jpg|\.jpeg|\.png)$/i;
            
          if (!allowExtension.exec(imageValue)) {
            alert('Invalid file type');
            imageConvert.value = '';
            return false;
          }
          else {
            if (imageConvert.files && imageConvert.files[0]) {
              var fileReader = new FileReader();
              fileReader.onload = function(e) {
                document.getElementById(
                            'imagePreview').innerHTML = 
                            '<img src="' + e.target.result
                            + '"/>';
              };
              fileReader.readAsDataURL(imageConvert.files[0]);
            }
          }

        }

        function myFunction(x) {
         x.classList.toggle("change");
        }

        function myFunction() {
         document.getElementById("dropDown").classList.toggle("show");
        }

        // Close the dropdown if the user clicks outside of it
        window.onclick = function(event) {
          if (!event.target.matches('.dropbtn')) {
            var dropdowns = document.getElementsByClassName("dropdown-content");
            var i;
            for (i = 0; i < dropdowns.length; i++) {
              var openDropdown = dropdowns[i];
              if (openDropdown.classList.contains('show')) {
                openDropdown.classList.remove('show');
              }
            }
          }
        }
     </script>

</body>

</html>